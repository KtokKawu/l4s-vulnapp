package l4svuln;import jakarta.servlet.http.HttpServlet;import jakarta.servlet.http.HttpServletRequest;import jakarta.servlet.http.HttpServletResponse;import jakarta.servlet.ServletException;import java.io.Writer;import java.util.Map;import java.util.Collections;import java.util.stream.Collectors;import org.apache.logging.log4j.Logger;import org.apache.logging.log4j.LogManager;public class VulnServlet extends HttpServlet {    protected void doGet(HttpServletRequest req, HttpServletResponse res) throws ServletException {        Logger logger = LogManager.getLogger();        try {            Map<String, String> headers = Collections.list(req.getHeaderNames()).stream().collect(Collectors.toMap(h -> h, req::getHeader));            res.setContentType("text/plain; charset=utf-8");            Writer writer = res.getWriter();            if(headers.containsKey("x-log")) {                writer.write("Logging to console using vulnerable log4j2 by header\n");                logger.info(headers.get("x-log"));            } else {                writer.write("Hello\n");            }                        String prm = req.getParameter("x-param");            if(prm == "l4s-test") {                writer.write("World\n");            } else {                writer.write("Logging to console using vulnerable log4j2 by parameter\n");                logger.info(prm);            }            writer.close();        } catch(Exception e) {            throw new ServletException(e.getMessage(), e);        }    }}